pipeline {
    agent any

    environment {
        // You can customize this prefix
        TF_VAR_bucket_name = "ritesh-awss3-t1"
    }

    stages {
        stage('Terraform Init') {
            steps {
                dir('s3') {
                    sh 'terraform init'
                }
            }
        }

        stage('Terraform Apply') {
            steps {
                dir('s3') {
                    sh 'terraform apply -auto-approve'
                }
            }
        }

        stage('Show Output') {
            steps {
                dir('s3') {
                    echo 'Bucket created successfully. Details:'
                    sh 'terraform output bucket_name'
                }
            }
        }
    }
}
