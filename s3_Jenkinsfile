pipeline {
    agent any

    environment {
        TF_VAR_bucket_name = "my-unique-s3-bucket-name-123456"  // or inject as parameter
        AWS_REGION = "us-east-1"
    }

    stages {
        stage('Initialize Terraform') {
            steps {
                dir('s3') {
                    sh 'terraform init'
                }
            }
        }

        stage('Plan Terraform') {
            steps {
                dir('s3') {
                    sh 'terraform plan'
                }
            }
        }

        stage('Apply Terraform') {
            steps {
                input "Proceed with Terraform apply?"
                dir('s3') {
                    sh 'terraform apply -auto-approve'
                }
            }
        }
    }
}
